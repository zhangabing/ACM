#include <bits/stdc++.h>
#include "RSA.h"
using namespace std;

void test () {
    RSA a;
    a.test();
}

int main()
{
//    test();
//    getchar();
//    getchar();
    system("clear");
    printf ("\n\n\n");
    puts ("**************************************************************************");
    puts ("**************************************************************************");
	puts ("*************************                  *******************************");
    puts ("*************************      Welcome!    *******************************");
    puts ("*************************                  *******************************");
    puts ("**************************************************************************");
    puts ("**************************************************************************");
    puts ("\n\nPlease press the Enter key to continue......");
	getchar();

	start:
	system("clear");
	printf ("\n\n\n");
    puts ("**************************************************************************");
    puts ("**************************************************************************");
    puts ("*******************                              *************************");
    puts ("*******************          请选择功能:         *************************");
    puts ("*******************  ~~~~~~~~~~~~~~~~~~~~~~~~~~  *************************");
    puts ("*******************    1：生成公钥私钥           *************************");
    puts ("*******************    2：加密明文               *************************");
    puts ("*******************    3：解密密文               *************************");
	puts ("*******************    4：退出程序               *************************");
    puts ("*******************                              *************************");
	puts ("**************************************************************************");
    puts ("**************************************************************************");
    printf ("\n\n                       请输出您的选择：");


    int op;
    RSA a;
    string Min;
    vector<long long> Mi;
    long long key, n;
    scanf ("%d", &op);
    Mi.clear();
    switch (op) {
    case 1:
        system ("clear");
        puts ("\n\n");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("\n");
        a.init();
        puts ("");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("\n\n请按回车键返回上一级......");
        getchar();
        getchar();
        goto start;
    case 2:
        system ("clear");
        puts ("\n\n");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("\n");
        puts ("               请在下方输入加密文本:");
        printf ("               ");
        cin >> Min;
        puts ("\n               请在下方输入公钥e:");
        printf ("               ");
        cin >> key;
        puts ("\n               请在下方输入公钥n:");
        printf ("               ");
        cin >> n;
        puts ("");
        a.encrypt(Min, key, n);

        puts ("\n\n请按回车键返回上一级......");
        getchar();
        getchar();
        goto start;
    case 3:
        system ("clear");
        puts ("\n\n");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("**************************************************************************");
        puts ("\n");
        puts ("               请在下方输入解密密文, 以-1终止:");
        printf ("               ");
        while (cin >> key, key != -1) {
            printf ("               ");
            Mi.push_back(key);
        }
        puts ("\n               请在下方输入私钥d:");
        printf ("               ");
        cin >> key;
        puts ("\n               请在下方输入私钥n:");
        printf ("               ");
        cin >> n;
        puts ("");
        a.decrypt(Mi, key, n);

        puts ("\n\n请按回车键返回上一级......");
        getchar();
        getchar();
        goto start;
    case 4:
        system("clear");
        printf ("\n\n\n");
		puts ("**************************************************************************");
		puts ("**************************************************************************");
		puts ("*************************                  *******************************");
		puts ("*************************  感谢您的使用！  *******************************");
		puts ("*************************                  *******************************");
		puts ("**************************************************************************");
		puts ("**************************************************************************");
		printf ("\n\n");
		break;
    default :
		printf ("\n\n                 输入功能编号错误！请按回车键继续......\n");
		getchar();
		getchar();
		goto start;
    }
    return 0;
}
